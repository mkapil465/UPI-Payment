<div class="transactions-container">
  <header class="header">
    <div class="header-content">
      <button class="btn-back" (click)="goBack()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Back
      </button>
      <h1>Transaction History</h1>
      <div></div>
    </div>
  </header>

  <div class="transactions-content">
    <div class="filters-section">
      <div class="search-box">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input
          type="text"
          [(ngModel)]="searchQuery"
          (input)="applyFilters()"
          placeholder="Search by recipient UPI ID..."
        />
      </div>

      <div class="filter-group">
        <label>Status:</label>
        <select [(ngModel)]="statusFilter" (change)="applyFilters()">
          <option value="all">All</option>
          <option value="success">Success</option>
          <option value="failed">Failed</option>
          <option value="pending">Pending</option>
        </select>
      </div>

      <div class="sort-buttons">
        <button class="btn-sort" (click)="sortByDate(false)" title="Sort by newest first">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <polyline points="19 12 12 19 5 12"></polyline>
          </svg>
          Date
        </button>
        <button class="btn-sort" (click)="sortByAmount(false)" title="Sort by highest amount">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <polyline points="19 12 12 19 5 12"></polyline>
          </svg>
          Amount
        </button>
      </div>
    </div>

    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <p>Loading transactions...</p>
    </div>

    <div *ngIf="!isLoading && filteredTransactions.length === 0" class="empty-state">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="1 4 1 10 7 10"></polyline>
        <polyline points="23 20 23 14 17 14"></polyline>
        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
      </svg>
      <h3>No transactions found</h3>
      <p>{{ searchQuery || statusFilter !== 'all' ? 'Try adjusting your filters' : 'Start sending money to see transactions here' }}</p>
    </div>

    <div *ngIf="!isLoading && filteredTransactions.length > 0" class="transactions-list">
      <div class="transaction-card" *ngFor="let transaction of paginatedTransactions">
        <div class="transaction-main">
          <div class="transaction-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <polyline points="19 12 12 19 5 12"></polyline>
            </svg>
          </div>
          <div class="transaction-details">
            <div class="transaction-recipient">{{ transaction.recipient_upi_id }}</div>
            <div class="transaction-date">{{ formatDate(transaction.created_at) }}</div>
            <div *ngIf="transaction.notes" class="transaction-notes">{{ transaction.notes }}</div>
          </div>
          <div class="transaction-amount-status">
            <div class="transaction-amount">{{ formatAmount(transaction.amount) }}</div>
            <span class="status-badge" [ngClass]="getStatusClass(transaction.status)">
              {{ transaction.status }}
            </span>
          </div>
        </div>
      </div>

      <div class="pagination" *ngIf="totalPages > 1">
        <button
          class="btn-page"
          (click)="goToPage(currentPage - 1)"
          [disabled]="currentPage === 1"
        >
          Previous
        </button>

        <div class="page-info">
          Page {{ currentPage }} of {{ totalPages }}
        </div>

        <button
          class="btn-page"
          (click)="goToPage(currentPage + 1)"
          [disabled]="currentPage === totalPages"
        >
          Next
        </button>
      </div>
    </div>
  </div>
</div>
